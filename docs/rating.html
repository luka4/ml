<!DOCTYPE html>
<html lang="sk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <!-- Google tag (gtag.js) -->
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-V448ND6YC6"></script>
    <script>
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-V448ND6YC6');
    </script>
    <title>Ko≈°ick√° Miniliga - Rating</title>
    <link rel="icon" href="favicon.ico" type="image/x-icon">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <link rel="stylesheet" href="styles/loader.css">
    <link rel="stylesheet" href="styles/shared.css">
    <link rel="stylesheet" href="styles/rating.css">
    <link rel="canonical" href="https://miniliga.online/rating.html" />
    <script src="auth.js"></script>
    <script src="https://cdn.onesignal.com/sdks/web/v16/OneSignalSDK.page.js" defer></script>
    <script src="onesignal-init.js" defer></script>
</head>
<body id="page-rating" class="loading">

<div id="pageLoader">
    <div class="loader">
        <div class="scene">
            <div class="ball"></div>
            <div class="racket">
                <div class="blade"></div>
                <div class="handle"></div>
            </div>
        </div>
        <div class="loading-text">Naƒç√≠tava sa</div>
    </div>
</div>

<div id="pageContent">
    <div id="mainNavContainer"></div>

    <div class="container" id="mainContainer">
        <h2>Aktu√°lny Rating Hr√°ƒçov</h2>
        <div class="info-trigger" onclick="openInfoModal()">‚ìò Ako funguje Rating?</div>
        <div class="scroll-hint">‚Üî Posu≈àte tabuƒæku pre viac ≈°tatist√≠k</div>
        <div class="table-wrapper" id="mainTableWrapper">
            <table id="mainTable">
                <thead>
                <tr>
                    <th rowspan="2" style="min-width: 20px;">#</th>
                    <th rowspan="2">Hr√°ƒç</th>
                    <th rowspan="2"><div class="team-filter-wrapper"><div class="team-filter-btn" onclick="toggleTeamDropdown(event)">T√≠m <span style="font-size: 0.8em">‚ñº</span></div><div id="teamDropdown" class="team-filter-dropdown"></div></div></th>
                    <th rowspan="2">Rating</th>
                    <th rowspan="2">Posl. <br/> Kolo</th>
                    <th rowspan="2">Forma</th>
<!--                    TODO temporary remove rebricek-->
<!--                    <th rowspan="2">Rebr√≠ƒçek</th>-->
                    <th colspan="6" class="border-left-thick">Z√°pasy Dvojhra (Singles)</th>
                    <th colspan="3" class="border-left-thick">Z√°pasy ≈†tvorhra (Doubles)</th>
                    <th rowspan="2" class="border-left-thick">Naj V√Ωhra</th>
                    <th rowspan="2">Naposledy Hral</th>
                    <th rowspan="2">Max Rating</th>
                    <th rowspan="2">Min Rating</th>
                </tr>
                <tr>
                    <th class="sub-singles border-left-thick">Z√°pasy</th><th class="sub-singles">V√Ωhry</th><th class="sub-singles">Prehry</th><th class="sub-singles">Sety</th><th class="sub-singles">√öspe≈°nos≈• Z√°pasy</th><th class="sub-singles">√öspe≈°nos≈• Sety</th>
                    <th class="sub-doubles border-left-thick">Z√°pasy</th><th class="sub-doubles">V√Ωhry</th><th class="sub-doubles">Prehry</th>
                </tr>
                </thead>
                <tbody id="mainTableBody"></tbody>
            </table>
        </div>
    </div>

    <div id="playerModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closePlayerModal()">&times;</span>
            <div id="selectedPlayerHeader"><div class="player-header-name" id="headerName"></div><div class="player-header-team" id="headerTeam"></div><div class="player-header-logo" id="headerTeamLogoWrapper"><img id="headerTeamLogo" alt="Team logo"></div></div>
            <div id="chartContainerWrapper">
                <canvas id="ratingChart"></canvas>
            </div>
            <div id="formHistoryWrapper">
                <div class="form-history-title">Forma (v≈°etky z√°pasy, posledn√© nov≈°ie vpravo)</div>
                <div id="formHistory" class="form-history"></div>
            </div>
            <div id="compareSection">
                <h3>Porovna≈•</h3>
                <form id="compareForm" class="compare-form-row">
                    <input id="compareInput" class="compare-input" type="text" list="comparePlayerList" placeholder="Zaƒçnite p√≠sa≈• meno hr√°ƒça..." autocomplete="off">
                    <button type="submit" class="compare-btn">Porovna≈•</button>
                    <button type="button" id="clearCompareBtn" class="compare-btn compare-clear">Vymaza≈•</button>
                </form>
                <div id="compareStatus" class="compare-status"></div>
                <div class="compare-matches">
                    <div class="compare-matches-title">Vz√°jomn√© z√°pasy</div>
                    <div id="compareMatchesList"></div>
                </div>
                <datalist id="comparePlayerList"></datalist>
            </div>
            <div id="derivedStatsSection">
                <div class="derived-stats-grid">
                    <div class="stats-list" id="derivedStatsList"></div>
                    <div class="stats-radar">
                        <canvas id="statsRadarChart"></canvas>
                    </div>
                </div>
                <div id="statsDescription" class="stats-description"></div>
                <div id="statsDisclaimer" class="stats-disclaimer"></div>
            </div>
            <div class="pie-row-title"><span>Prehƒæad</span></div>
            <div id="generalStatsWrapper">
                <div class="stat-card border-blue"><div class="stat-label">Aktu√°lny Rating</div><div id="currentRatingVal" class="stat-value"></div></div>
                <div class="stat-card border-blue"><div class="stat-label">Priemern√Ω Rating S√∫pera</div><div id="avgOpponentVal" class="stat-value"></div><div class="stat-rating" style="font-size:0.75em">(Iba dvojhry)</div></div>
            </div>
            <div class="pie-row-title"><span>Highlighty</span></div>
            <div id="statsHighlightsWrapper">
                <div class="stat-card border-green"><div class="stat-label">Najlep≈°ia V√Ωhra</div><div id="bestWinContainer"><div class="stat-value" id="bestWinName"></div><div class="stat-rating" id="bestWinRating"></div></div></div>
                <div class="stat-card border-red"><div class="stat-label">Najhor≈°ia Prehra</div><div id="worstLossContainer"><div class="stat-value" id="worstLossName"></div><div class="stat-rating" id="worstLossRating"></div></div></div>
            </div>
            <div class="pie-row-title"><span>≈†tatistiky Dvojhry</span></div>
            <div class="pie-row-wrapper">
                <div class="pie-card"><div class="pie-header"><div class="pie-title">Z√°pasy (Dvojhra)</div><div class="pie-total-val" id="matchesTotalVal">0</div></div><div class="pie-canvas-holder"><canvas id="matchesChart"></canvas></div><div class="custom-legend"><div class="legend-row"><span class="legend-label">V√Ωhry</span><div><span class="legend-val val-green" id="matchesWinsVal">0</span><span class="pct-text" id="matchesWinsPct">(0%)</span></div></div><div class="legend-row"><span class="legend-label">Prehry</span><div><span class="legend-val val-red" id="matchesLossVal">0</span><span class="pct-text" id="matchesLossPct">(0%)</span></div></div></div></div>
                <div class="pie-card"><div class="pie-header"><div class="pie-title">Sety (Dvojhra)</div><div class="pie-total-val" id="setsTotalVal">0</div></div><div class="pie-canvas-holder"><canvas id="setsChart"></canvas></div><div class="custom-legend"><div class="legend-row"><span class="legend-label">V√Ωhry</span><div><span class="legend-val val-green" id="setsWinsVal">0</span><span class="pct-text" id="setsWinsPct">(0%)</span></div></div><div class="legend-row"><span class="legend-label">Prehry</span><div><span class="legend-val val-red" id="setsLossVal">0</span><span class="pct-text" id="setsLossPct">(0%)</span></div></div></div></div>
            </div>
            <div class="pie-row-title"><span>≈†tatistiky ≈†tvorhry</span></div>
            <div class="pie-row-wrapper">
                <div class="pie-card"><div class="pie-header"><div class="pie-title">Z√°pasy (≈†tvorhra)</div><div class="pie-total-val" id="dMatchesTotalVal">0</div></div><div class="pie-canvas-holder"><canvas id="dMatchesChart"></canvas></div><div class="custom-legend"><div class="legend-row"><span class="legend-label">V√Ωhry</span><div><span class="legend-val val-green" id="dMatchesWinsVal">0</span><span class="pct-text" id="dMatchesWinsPct">(0%)</span></div></div><div class="legend-row"><span class="legend-label">Prehry</span><div><span class="legend-val val-red" id="dMatchesLossVal">0</span><span class="pct-text" id="dMatchesLossPct">(0%)</span></div></div></div></div>
                <div class="pie-card"><div class="pie-header"><div class="pie-title">Sety (≈†tvorhra)</div><div class="pie-total-val" id="dSetsTotalVal">0</div></div><div class="pie-canvas-holder"><canvas id="dSetsChart"></canvas></div><div class="custom-legend"><div class="legend-row"><span class="legend-label">V√Ωhry</span><div><span class="legend-val val-green" id="dSetsWinsVal">0</span><span class="pct-text" id="dSetsWinsPct">(0%)</span></div></div><div class="legend-row"><span class="legend-label">Prehry</span><div><span class="legend-val val-red" id="dSetsLossVal">0</span><span class="pct-text" id="dSetsLossPct">(0%)</span></div></div></div></div>
            </div>
            <div id="historyContainer"></div>
        </div>
    </div>

    <div id="infoModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeInfoModal()">&times;</span>
            <div class="info-content">
                <div class="info-title">Ako funguje Rating?</div>

                <div class="info-section" style="background-color: var(--color-info-soft); padding: 10px; border-radius: 5px; margin-bottom: 20px;">
                    <b>üí° Tip:</b> Kliknut√≠m na meno hr√°ƒça v tabuƒæke zobraz√≠te jeho <b>detailn√Ω profil</b> ‚Äì grafy v√Ωvoja ratingu, kol√°ƒçov√© grafy √∫spe≈°nosti a kompletn√∫ hist√≥riu z√°pasov.
                </div>

                <div class="info-section">
                    <p class="info-text">
                        Ratingov√Ω syst√©m v Ko≈°ickej Minilige je zalo≈æen√Ω na modifikovanom <b>ELO syst√©me</b> (podobnom ako v ≈°achu), ktor√Ω je prisp√¥soben√Ω pre stoln√Ω tenis. Cieƒæom je spravodlivo ohodnoti≈• aktu√°lnu v√Ωkonnos≈• hr√°ƒçov.
                    </p>
                    <ul class="info-list">
                        <li><b>V≈°etci zaƒç√≠naj√∫ na 100:</b> Ka≈æd√Ω nov√Ω hr√°ƒç vstupuje do syst√©mu so z√°kladn√Ωm ratingom 100.</li>
                        <li><b>Poƒç√≠taj√∫ sa sety, nielen v√Ωhry:</b> Syst√©m nepozer√° len na to, ƒçi ste vyhrali z√°pas, ale <b>koƒæko setov</b> ste uhrali. V√Ωhra 3:0 v√°m prid√° viac bodov (a s√∫perovi viac vezme) ako v√Ωhra 3:2.</li>
                        <li><b>Sila s√∫pera rozhoduje:</b> Ak poraz√≠te hr√°ƒça s vy≈°≈°√≠m ratingom, z√≠skate viac bodov. Ak prehr√°te s v√Ωrazne silnej≈°√≠m hr√°ƒçom, strat√≠te len m√°lo bodov (syst√©m to oƒçak√°val).</li>
                        <li><b>Aj prehra m√¥≈æe znamena≈• zisk:</b> Ak m√°te v√Ωrazne ni≈æ≈°√≠ rating ako s√∫per, ale uhr√°te proti nemu 1 alebo 2 sety, m√¥≈æete si polep≈°i≈• (z√≠ska≈• body) aj napriek tomu, ≈æe ste z√°pas celkovo prehrali.</li>
                        <li><b>Stabilita (K-Faktor):</b> Prv√Ωch 5 z√°pasov sa v√°≈° rating men√≠ r√Ωchlej≈°ie, aby sa ƒço najsk√¥r na≈°la va≈°a "skutoƒçn√°" √∫rove≈à. Po odohrat√≠ viac ako 5 z√°pasov sa rating stabilizuje.</li>
                    </ul>
                </div>

                <div class="info-title" style="margin-top: 25px;">Farebn√° legenda (Stabilita)</div>
                <div class="info-section">
                    <p class="info-text">Farba ratingu v tabuƒæke naznaƒçuje ≈°tatistick√∫ presnos≈• √∫dajov:</p>
                    <ul class="info-list">
                        <li><b style="color: var(--color-danger);">ƒåerven√° (0-10 z√°pasov):</b> <b>Nov√°ƒçik / Doƒçasn√Ω.</b> Hr√°ƒç odohral m√°lo z√°pasov, hodnota sa m√¥≈æe r√Ωchlo meni≈• a nemus√≠ plne odr√°≈æa≈• jeho √∫rove≈à.</li>
                        <li><b style="color: var(--color-warning);">Oran≈æov√° (11-20 z√°pasov):</b> <b>Rozv√≠jaj√∫ci sa.</b> Presnos≈• ratingu sa zvy≈°uje.</li>
                        <li><b style="color: var(--color-success);">Zelen√° (21+ z√°pasov):</b> <b>Stabiln√Ω.</b> Hr√°ƒç odohral dostatok z√°pasov, rating je ≈°tatisticky presn√Ω.</li>
                    </ul>
                </div>

                <div class="info-title" style="margin-top: 25px;">Matematick√Ω Vzorec</div>
                <div class="info-section">
                    <p class="info-text">
                        Syst√©m najprv vypoƒç√≠ta <b>Oƒçak√°van√Ω poƒçet setov</b>, ktor√© by ste mali uhra≈• vzhƒæadom na rozdiel ratingov. Potom porovn√° tento odhad s realitou.
                    </p>

                    <div class="formula-box">
                        Nov√Ω Rating = <span class="math-var">R_old</span> + <span class="math-var">K</span> √ó (<span class="math-var">Sety_skutoƒçn√©</span> - <span class="math-var">Sety_oƒçak√°van√©</span>)
                    </div>

                    <p class="info-text">Kde:</p>
                    <ul class="info-list" style="font-size: 0.9em;">
                        <li><span class="math-var">R_old</span>: V√°≈° aktu√°lny rating pred z√°pasom.</li>
                        <li><span class="math-var">K</span>: V√°hov√Ω faktor (30 pre nov√°ƒçikov, kles√° na 10 pre stabiln√Ωch hr√°ƒçov).</li>
                        <li><span class="math-var">Sety_oƒçak√°van√©</span>: Vypoƒç√≠tan√© podƒæa vzorca: <br>
                            \( E_a = \frac{PoƒçetSetov}{1 + 10^{(R_b - R_a) / 300}} \)
                        </li>
                        <li>(Deliteƒæ 300 urƒçuje citlivos≈• syst√©mu na rozdiely v ratingu).</li>
                    </ul>

                    <p class="info-text" style="margin-top:15px; font-style: italic; font-size: 0.9em; color:var(--color-muted);">
                        * Pre ≈°tvorhry (Doubles) sa berie do √∫vahy priemern√Ω rating a priemern√Ω K-faktor dvojice. Z√≠skan√© body sa n√°sledne delia medzi oboch hr√°ƒçov.
                    </p>
                </div>
            </div>
        </div>
    </div>

    <footer class="site-footer">
        <div class="footer-container">
            <div class="footer-section">
                <h3 class="footer-title">Ko≈°ick√° Miniliga</h3>
                <p class="footer-description">V√Ωsledky, tabuƒæky a ratingy hr√°ƒçov pre Ko≈°ick√∫ stolnotenisov√∫ Miniligu. Nez√°visl√Ω projekt.</p>
            </div>
            <div class="footer-section">
                <h4 class="footer-heading">Navig√°cia</h4>
                <nav class="footer-nav">
                    <a href="index.html" class="footer-link">Domov</a>
                    <a href="results.html" class="footer-link">V√Ωsledky</a>
                    <a href="rating.html" class="footer-link">Rating</a>
                    <a href="table.html" class="footer-link">Tabuƒæka</a>
                    <a href="prediction.html" class="footer-link">Predikcie</a>
                </nav>
            </div>
            <div class="footer-section">
                <h4 class="footer-heading">O str√°nke</h4>
                <p class="footer-text">Stoln√Ω tenis v Ko≈°iciach</p>
                <p class="footer-text">Syst√©m ratingov zalo≈æen√Ω na ELO</p>
                <p class="footer-text">Kontakty: <a href="mailto:info@miniliga.online">info@miniliga.online</a></p>
            </div>
        </div>
        <div class="footer-bottom">
            <p class="footer-copyright">&copy; <span id="currentYear"></span> miniliga.online. Nez√°visl√Ω projekt pre zobrazenie v√Ωsledkov Ko≈°ickej Miniligy.</p>
        </div>
    </footer>
</div>

<script src="googleSheetsLoader.js?v=2"></script>
<script src="matchData.js?v=7"></script>
<script src="script.js?v=10"></script>
</body>
</html>
